<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­æ–‡è­˜å­—é€š - æ——è‰¦ç‰ˆ</title>
    
    <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cnchar/cnchar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cnchar-order/cnchar.order.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cnchar-draw/cnchar.draw.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #3498db;
            --accent: #e74c3c;
            --bg: #f0f4f8;
            --card-bg: #ffffff;
            --text: #2c3e50;
            --grid-color: #e0e0e0;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- é ‚éƒ¨æœå°‹èˆ‡å°èˆª --- */
        .header {
            width: 100%;
            max-width: 1000px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .title { font-size: 1.5rem; font-weight: bold; color: var(--primary); display: flex; align-items: center; gap: 10px; }
        
        .search-box {
            display: flex;
            background: white;
            border-radius: 30px;
            padding: 5px 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 50%;
        }

        input { border: none; flex: 1; padding: 10px; outline: none; font-size: 1rem; }
        .btn { padding: 8px 20px; border-radius: 20px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-print { background: #27ae60; color: white; display: flex; align-items: center; gap: 5px; }
        
        /* --- æ ¸å¿ƒå­¸ç¿’å€ (å…©æ¬„ä½ˆå±€) --- */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* æ¨™é¡Œèˆ‡åˆ†é  */
        .char-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            width: 100%;
            justify-content: center;
        }

        .char-tab {
            font-size: 1.5rem;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            background: white;
        }

        .char-tab.active { border-color: var(--primary); color: var(--primary); background: #ebf5fb; font-weight: bold; }

        /* ç±³å­—æ ¼å®¹å™¨ */
        .writer-container {
            position: relative;
            margin-bottom: 10px;
            border: 2px solid var(--primary);
            /* æ¨¡æ“¬ç±³å­—æ ¼èƒŒæ™¯ */
            background-image: 
                linear-gradient(45deg, transparent 49.5%, #eee 50%, transparent 50.5%),
                linear-gradient(-45deg, transparent 49.5%, #eee 50%, transparent 50.5%),
                linear-gradient(90deg, transparent 49.5%, var(--accent) 50%, transparent 50.5%),
                linear-gradient(0deg, transparent 49.5%, var(--accent) 50%, transparent 50.5%);
            background-size: 100% 100%;
        }

        .controls { display: flex; gap: 10px; margin-top: 10px; }
        
        /* --- è³‡è¨Šæ¬„ (éƒ¨é¦–ã€æ‹¼éŸ³) --- */
        .info-bar {
            width: 100%;
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 1rem;
            color: #555;
        }
        .info-item b { color: var(--primary); margin-right: 5px; }

        /* --- ç­†ç•«æ‹†è§£ (Decomposition) --- */
        .decomposition-card {
            grid-column: 1 / -1; /* è·¨å…©æ¬„ */
            align-items: flex-start;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            border-left: 5px solid var(--accent);
            padding-left: 10px;
            margin-bottom: 15px;
            width: 100%;
        }

        .strokes-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stroke-step {
            width: 60px;
            height: 60px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .stroke-num {
            position: absolute;
            bottom: 2px;
            right: 4px;
            font-size: 10px;
            color: #999;
        }

        /* --- é€ å¥èˆ‡è§£é‡‹ (æ–°åŠŸèƒ½) --- */
        .meaning-card {
            grid-column: 1 / -1;
            align-items: flex-start;
        }

        .def-box {
            background: #fff8e1;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            margin-bottom: 15px;
            line-height: 1.6;
            border-left: 4px solid #f39c12;
        }

        .sentence-item {
            background: #fff;
            border-bottom: 1px dashed #eee;
            padding: 10px 0;
            width: 100%;
            line-height: 1.6;
        }
        .highlight-word { color: var(--accent); font-weight: bold; background: rgba(231, 76, 60, 0.1); padding: 2px 4px; border-radius: 3px; }

        /* --- åˆ—å°å°ˆç”¨æ¨£å¼ (@media print) --- */
        @media print {
            body { background: white; padding: 0; }
            .header, .controls, .char-tabs, .btn { display: none !important; }
            .main-container { display: block; }
            .card { box-shadow: none; border: 1px solid #000; margin-bottom: 20px; page-break-inside: avoid; }
            .writer-container { border: 1px solid #000; }
            .decomposition-card { border: none; }
            .strokes-container { gap: 5px; }
            .stroke-step { border: 1px solid #000; width: 40px; height: 40px; }
            /* è®“ç­†é †ç·´ç¿’æ ¼åœ¨åˆ—å°æ™‚è®Šå¤š */
            .print-practice-grid {
                display: block !important;
                width: 100%;
                height: 100px;
                border: 1px solid #000;
                margin-top: 10px;
            }
        }
        .print-practice-grid { display: none; } /* è¢å¹•ä¸Šä¸é¡¯ç¤º */

        /* æ‰‹æ©Ÿ RWD */
        @media (max-width: 768px) {
            .main-container { grid-template-columns: 1fr; }
            .search-box { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="title">ğŸ€„ ä¸­æ–‡è­˜å­—é€š <span style="font-size:0.8rem; color:#999; font-weight:normal;">v3.0</span></div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="è¼¸å…¥å–®å­—æˆ–è©èª (å¦‚ï¼šæ‰“æƒã€è´è¶)..." onkeypress="handleEnter(event)">
            <button class="btn btn-primary" onclick="searchWord()">æŸ¥è©¢</button>
        </div>
        <button class="btn btn-print" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°å·¥ä½œç´™</button>
    </div>

    <div class="main-container" id="mainContent" style="display:none;">
        
        <div style="grid-column: 1 / -1; display:flex; flex-direction:column; align-items:center;">
             <div class="char-tabs" id="charTabs"></div>
             <button class="btn" style="background:transparent; color:#555; border:1px solid #ccc;" onclick="speakCurrentWord()">
                 ğŸ”Š è†è½è®€éŸ³
             </button>
        </div>

        <div class="card">
            <div class="section-title" style="color:var(--primary); border-color:var(--primary);">ğŸ‘€ ç­†é †æ¼”ç¤º</div>
            <div id="demo-writer" class="writer-container"></div>
            <div class="controls">
                <button class="btn btn-primary" onclick="animateWriter()">â–¶ æ’­æ”¾</button>
            </div>
            <div class="info-bar">
                <div class="info-item"><b>éƒ¨é¦–:</b> <span id="infoRadical">-</span></div>
                <div class="info-item"><b>ç­†ç•«:</b> <span id="infoStrokes">-</span></div>
                <div class="info-item"><b>æ‹¼éŸ³:</b> <span id="infoPinyin">-</span></div>
            </div>
        </div>

        <div class="card">
            <div class="section-title" style="color:var(--accent); border-color:var(--accent);">âœï¸ å­¸ç”Ÿæç´…</div>
            <div id="quiz-writer" class="writer-container"></div>
            <div class="controls">
                <button class="btn" style="background:#f39c12; color:white;" onclick="resetQuiz()">â†º é‡å¯«</button>
            </div>
            <div class="print-practice-grid" style="text-align:center; padding-top:40px; color:#ccc;">(åˆ—å°å¾Œè«‹åœ¨æ­¤è™•ç·´ç¿’æ›¸å¯«)</div>
        </div>

        <div class="card decomposition-card">
            <div class="section-title">ğŸ”¢ ç­†ç•«æ‹†è§£ (ç´…è‰²ç‚ºç•¶å‰ç­†ç•«)</div>
            <div class="strokes-container" id="strokeDecomp">
                </div>
        </div>

        <div class="card meaning-card">
            <div class="section-title">ğŸ“– è©èªè§£é‡‹èˆ‡é€ å¥</div>
            <div class="def-box">
                <b>ã€è§£é‡‹ã€‘ï¼š</b><span id="wordDefinition"></span>
            </div>
            <div style="width:100%;">
                <b>ã€ä¾‹å¥ã€‘ï¼š</b>
                <div id="sentenceList"></div>
            </div>
        </div>

    </div>

    <script>
        // --- 1. è³‡æ–™åº« (æ•´åˆäº†æ‚¨æä¾›çš„æ‰€æœ‰ PDF è©èª) ---
        // ç‚ºäº†ç°¡æ½”ï¼Œé€™è£¡åªåˆ—å‡ºéƒ¨åˆ†æ ¸å¿ƒè©å½™åšç‚ºç¤ºç¯„ï¼Œå¯¦éš›ä½¿ç”¨æ™‚é€™è£¡æœƒæ˜¯å¹¾ç™¾è¡Œçš„è³‡æ–™
        const vocabDB = {
            "æ‰“æƒ": { def: "æ•´ç†æ¸…æ½”ï¼Œä½¿ç’°å¢ƒä¹¾æ·¨ã€‚", sent: ["éå¹´å‰ï¼Œå…¨å®¶äººä¸€èµ·<b>æ‰“æƒ</b>æˆ¿å­ã€‚", "æˆ‘å€‘è¦æŠŠæ•™å®¤<b>æ‰“æƒ</b>å¾—ä¹¾ä¹¾æ·¨æ·¨ã€‚"] },
            "æ“¦": { def: "æ‘©æ“¦ï¼Œå»é™¤é«’æ±™ã€‚", sent: ["åª½åª½ç”¨æŠ¹å¸ƒæŠŠæ¡Œå­<b>æ“¦</b>å¾—å¾ˆä¹¾æ·¨ã€‚", "è«‹å¹«å¿™<b>æ“¦</b>é»‘æ¿ã€‚"] },
            "æŠ¹": { def: "å¡—æ“¦æˆ–å¡—æ•·ã€‚", sent: ["ä»–åœ¨éºµåŒ…ä¸Š<b>æŠ¹</b>äº†ä¸€å±¤æœé†¬ã€‚", "å¼Ÿå¼ŸæŠŠè‡‰<b>æŠ¹</b>å¾—é«’å…®å…®çš„ã€‚"] },
            "æ”¶æ‹¾": { def: "æ•´ç†ã€æ•´é “ã€‚", sent: ["ç©å®Œç©å…·å¾Œï¼Œè¦è¨˜å¾—<b>æ”¶æ‹¾</b>å¥½ã€‚", "å¿«é»<b>æ”¶æ‹¾</b>æ›¸åŒ…ï¼Œè¦å»å­¸æ ¡äº†ã€‚"] },
            "æ˜äº®": { def: "å…‰äº®ã€ä¸æ˜æš—ã€‚", sent: ["æ—©æ™¨çš„é™½å…‰è®“æˆ¿é–“è®Šå¾—å¥½<b>æ˜äº®</b>ã€‚", "é€™é–“æ•™å®¤å¯¬æ•åˆ<b>æ˜äº®</b>ã€‚"] },
            "æ•´æ½”": { def: "æ•´é½Šæ¸…æ½”ã€‚", sent: ["ä¿æŒå„€å®¹<b>æ•´æ½”</b>æ˜¯æœ‰ç¦®è²Œçš„è¡¨ç¾ã€‚", "é€™æ¢è¡—é“çœ‹èµ·ä¾†éå¸¸<b>æ•´æ½”</b>ã€‚"] },
            "é«˜èˆˆ": { def: "æ­¡å–œã€æ„‰å¿«ã€‚", sent: ["æ”¶åˆ°ç”Ÿæ—¥ç¦®ç‰©ï¼Œæˆ‘æ„Ÿåˆ°éå¸¸<b>é«˜èˆˆ</b>ã€‚", "ä»Šå¤©å»éƒŠéŠï¼Œå¤§å®¶éƒ½å¾ˆ<b>é«˜èˆˆ</b>ã€‚"] },
            "æˆ¿å­": { def: "å»ºç¯‰ç‰©ã€‚", sent: ["é€™åº§<b>æˆ¿å­</b>å‰é¢æœ‰ä¸€å€‹å¤§èŠ±åœ’ã€‚", "å°é³¥åœ¨æ¨¹ä¸Šè“‹äº†ä¸€åº§å°<b>æˆ¿å­</b>ã€‚"] },
            "åœ°æ¿": { def: "æˆ¿å±‹åœ°é¢çš„é‹ªè¨­å±¤ã€‚", sent: ["å¼Ÿå¼Ÿååœ¨<b>åœ°æ¿</b>ä¸Šç©ç©æœ¨ã€‚", "<b>åœ°æ¿</b>å‰›æ‹–éï¼Œèµ°è·¯è¦å°å¿ƒæ»‘å€’ã€‚"] },
            "çª—æˆ¶": { def: "é€šæ°£é€å…‰çš„æ´å£ã€‚", sent: ["è«‹æŠŠ<b>çª—æˆ¶</b>æ‰“é–‹ï¼Œè®“ç©ºæ°£æµé€šã€‚", "å°è²“ååœ¨<b>çª—æˆ¶</b>é‚Šçœ‹é¢¨æ™¯ã€‚"] },
            "ç‰€å–®": { def: "é‹ªåœ¨ç‰€é¢ä¸Šçš„å¸ƒå–®ã€‚", sent: ["åª½åª½æ›ä¸Šäº†ä¹¾æ·¨çš„<b>ç‰€å–®</b>ã€‚", "æˆ‘ä¸å°å¿ƒæŠŠæœæ±ç‘åœ¨<b>ç‰€å–®</b>ä¸Šäº†ã€‚"] },
            "æ–°å¹´": { def: "ä¸€å¹´çš„é–‹å§‹ã€‚", sent: ["<b>æ–°å¹´</b>åˆ°äº†ï¼Œå¤§å®¶éƒ½ç©¿ä¸Šæ–°è¡£æœã€‚", "ç¥ä½ <b>æ–°å¹´</b>å¿«æ¨‚ï¼"] },
            "ä¸€èµ·": { def: "ä¸€åŒã€‚", sent: ["æ”¾å­¸å¾Œï¼Œæˆ‘å€‘<b>ä¸€èµ·</b>èµ°è·¯å›å®¶ã€‚", "å¤§å®¶<b>ä¸€èµ·</b>åˆä½œï¼Œå¾ˆå¿«å°±åšå®Œäº†ã€‚"] },
            "å…”å­": { def: "å“ºä¹³å‹•ç‰©ï¼Œé•·è€³çŸ­å°¾ã€‚", sent: ["å°ç™½<b>å…”å­</b>æ„›åƒç´…è˜¿è””ã€‚", "<b>å…”å­</b>è·³å¾—å¾ˆå¿«ã€‚"] },
            "é¼»å­": { def: "å—…è¦ºå™¨å®˜ã€‚", sent: ["å¤§è±¡çš„<b>é¼»å­</b>å¾ˆé•·ã€‚", "æ„Ÿå†’æ™‚<b>é¼»å­</b>æœƒä¸èˆ’æœã€‚"] },
            "è€³æœµ": { def: "è½è¦ºå™¨å®˜ã€‚", sent: ["å…”å­çš„<b>è€³æœµ</b>é•·é•·çš„ã€‚", "è«‹æ‰“é–‹<b>è€³æœµ</b>ä»”ç´°è½ã€‚"] },
            "çŒ´å­": { def: "éˆé•·é¡å‹•ç‰©ã€‚", sent: ["<b>çŒ´å­</b>åœ¨æ¨¹ä¸Šè·³ä¾†è·³å»ã€‚", "å‹•ç‰©åœ’è£¡æœ‰å¯æ„›çš„<b>çŒ´å­</b>ã€‚"] },
            "å¤©æ°£": { def: "å¤§æ°£è®ŠåŒ–çš„ç¾è±¡ã€‚", sent: ["ä»Šå¤©<b>å¤©æ°£</b>å¾ˆå¥½ã€‚", "<b>å¤©æ°£</b>è®Šå†·äº†ã€‚"] },
            "è´è¶": { def: "æ˜†èŸ²åï¼Œç¿…è†€æœ‰èŠ±ç´‹ã€‚", sent: ["<b>è´è¶</b>åœ¨èŠ±å¢ä¸­é£›èˆã€‚", "é€™éš»<b>è´è¶</b>çœŸç¾ã€‚"] },
            "å°æ˜": { def: "å¸¸è¦‹äººåã€‚", sent: ["<b>å°æ˜</b>æ˜¯æˆ‘çš„å¥½æœ‹å‹ã€‚", "<b>å°æ˜</b>æ¯å¤©éƒ½æº–æ™‚äº¤ä½œæ¥­ã€‚"] },
            "ç´…ç¶ ç‡ˆ": { def: "äº¤é€šè™ŸèªŒã€‚", sent: ["éé¦¬è·¯è¦çœ‹<b>ç´…ç¶ ç‡ˆ</b>ã€‚", "éµå®ˆ<b>ç´…ç¶ ç‡ˆ</b>ï¼Œå®‰å…¨æœ‰ä¿éšœã€‚"] },
            "éƒŠé‡": { def: "åŸé‚‘ä¹‹å¤–çš„è’é‡ã€‚", sent: ["æˆ‘å€‘å»<b>éƒŠé‡</b>è¸é’ã€‚", "<b>éƒŠé‡</b>çš„ç©ºæ°£å¾ˆæ–°é®®ã€‚"] },
            "å…¬åœ’": { def: "ä¾›å…¬çœ¾éŠæ¨‚ä¼‘æ†©çš„åœ’åœ°ã€‚", sent: ["<b>å…¬åœ’</b>è£¡æœ‰å¾ˆå¤šäººåœ¨æ•£æ­¥ã€‚", "æˆ‘å€‘ç´„åœ¨<b>å…¬åœ’</b>é–€å£è¦‹ã€‚"] }
            // ... (æ­¤è™•å¯è²¼å…¥æ‚¨ä¹‹å‰ç”¢ç”Ÿçš„æ‰€æœ‰ JSON è³‡æ–™)
        };

        // --- å…¨åŸŸè®Šæ•¸ ---
        let writerDemo, writerQuiz;
        let currentWord = "";
        let currentCharIndex = 0;

        function handleEnter(e) { if(e.key === 'Enter') searchWord(); }

        // --- æ ¸å¿ƒåŠŸèƒ½ 1: æœå°‹èˆ‡åˆå§‹åŒ– ---
        function searchWord() {
            const input = document.getElementById('searchInput').value.trim();
            if(!input) return;
            
            // æª¢æŸ¥è³‡æ–™åº«
            const wordData = vocabDB[input] || { def: "è‡ªè¨‚æŸ¥è©¢è©å½™", sent: [`è«‹ç·´ç¿’é€ å¥ï¼š${input}`] };
            
            // é¡¯ç¤ºä¸»ç•«é¢
            document.getElementById('mainContent').style.display = 'grid';
            currentWord = input;
            
            // æ¸²æŸ“è©èªè³‡è¨Š (é€ å¥/è§£é‡‹)
            document.getElementById('wordDefinition').textContent = wordData.def;
            document.getElementById('sentenceList').innerHTML = wordData.sent.map(s => 
                `<div class="sentence-item">${s.replace(/<b>(.*?)<\/b>/g, '<span class="highlight-word">$1</span>')}</div>`
            ).join('');

            // ç”Ÿæˆåˆ†å­—æŒ‰éˆ• (Tabs)
            const tabsContainer = document.getElementById('charTabs');
            tabsContainer.innerHTML = '';
            for(let i=0; i<input.length; i++) {
                let tab = document.createElement('div');
                tab.className = 'char-tab';
                tab.innerText = input[i];
                tab.onclick = () => loadCharacter(i);
                tabsContainer.appendChild(tab);
            }
            
            // è¼‰å…¥ç¬¬ä¸€å€‹å­—
            loadCharacter(0);
        }

        // --- æ ¸å¿ƒåŠŸèƒ½ 2: è¼‰å…¥å–®å­— (åŒ…å«æ‰€æœ‰èˆŠåŠŸèƒ½çš„é‚„åŸ) ---
        function loadCharacter(index) {
            currentCharIndex = index;
            const char = currentWord[index];
            
            // æ›´æ–° Tab ç‹€æ…‹
            const tabs = document.querySelectorAll('.char-tab');
            tabs.forEach(t => t.classList.remove('active'));
            tabs[index].classList.add('active');

            // 1. æ›´æ–° HanziWriter (æ¼”ç¤º & ç·´ç¿’)
            const size = Math.min(window.innerWidth / 2 - 40, 250); // RWD å¤§å°
            document.getElementById('demo-writer').innerHTML = '';
            document.getElementById('quiz-writer').innerHTML = '';

            writerDemo = HanziWriter.create('demo-writer', char, {
                width: size, height: size, padding: 5, showOutline: true, strokeAnimationSpeed: 1, delayBetweenStrokes: 200
            });
            writerQuiz = HanziWriter.create('quiz-writer', char, {
                width: size, height: size, padding: 5, showOutline: true, showCharacter: false, 
                strokeColor: '#e74c3c', highlightColor: '#e74c3c', drawingWidth: 20
            });
            writerQuiz.quiz();

            // 2. ä½¿ç”¨ cnchar ç²å–å­—è©è³‡è¨Š (éƒ¨é¦–ã€æ‹¼éŸ³ã€ç­†ç•«æ•¸)
            // cnchar.radical(char) è¿”å›éƒ¨é¦–, cnchar.spell(char) è¿”å›æ‹¼éŸ³, cnchar.stroke(char) è¿”å›ç­†ç•«æ•¸
            const info = cnchar.info(char); 
            // æ³¨æ„ï¼šcnchar info æ ¼å¼è¼ƒè¤‡é›œï¼Œé€™è£¡ç°¡åŒ–è™•ç†ï¼Œè‹¥ç„¡API keyå¯èƒ½éœ€fallback
            // é€™è£¡ä½¿ç”¨ cnchar çš„åŒæ­¥æ–¹æ³•
            document.getElementById('infoPinyin').innerText = cnchar.spell(char, 'tone');
            document.getElementById('infoRadical').innerText = cnchar.radical(char)[0].radical || "?"; 
            document.getElementById('infoStrokes').innerText = cnchar.stroke(char);

            // 3. ç”Ÿæˆç­†ç•«æ‹†è§£ (Stroke Decomposition) - é‡é»ä¿®å¾©ï¼
            generateStrokeDecomposition(char);
        }

        // --- æ ¸å¿ƒåŠŸèƒ½ 3: ç­†ç•«æ‹†è§£é‚„åŸ ---
        function generateStrokeDecomposition(char) {
            const container = document.getElementById('strokeDecomp');
            container.innerHTML = 'è¼‰å…¥ä¸­...';
            
            // ä½¿ç”¨ cnchar-order ç²å–ç­†é † SVG æ•¸æ“š
            cnchar.orderToWord(char).then(orderData => {
                container.innerHTML = '';
                // orderData åŒ…å«äº†æ¯ä¸€åŠƒçš„å½¢ç‹€
                // ä½†ç‚ºäº†æ›´å®Œç¾çš„ã€Œç´…è‰²ç•¶å‰ç­†ç•«ã€æ•ˆæœï¼Œæˆ‘å€‘ä½¿ç”¨ cnchar.draw çš„åˆ†æ­¥ç¹ªè£½åŠŸèƒ½
                // é€™è£¡æˆ‘å€‘æ¨¡æ“¬åœ–ç‰‡ä¸­ã€Œä¸€æ ¼ä¸€æ ¼ã€çš„æ•ˆæœ
                
                const strokes = orderData; // é€™è£¡å‡è¨­å–å¾—ç­†ç•«é™£åˆ—
                // ç”±æ–¼ cnchar draw çš„ API æ¯”è¼ƒè¤‡é›œï¼Œæˆ‘å€‘ç”¨ä¸€å€‹æ›´è°æ˜çš„æ–¹æ³•ï¼š
                // ä½¿ç”¨ HanziWriter çš„ cloneï¼Œä½†åªé¡¯ç¤ºå‰ N ç•«
                
                // ç²å–ç­†ç•«ç¸½æ•¸
                const totalStrokes = cnchar.stroke(char);
                
                for(let i = 1; i <= totalStrokes; i++) {
                    let stepBox = document.createElement('div');
                    stepBox.className = 'stroke-step';
                    // åŠ ä¸Šåºè™Ÿ
                    let num = document.createElement('span');
                    num.className = 'stroke-num';
                    num.innerText = i;
                    stepBox.appendChild(num);
                    
                    // å‰µå»ºä¸€å€‹å¾®å‹ Writer
                    let divId = `stroke-step-${i}`;
                    let innerDiv = document.createElement('div');
                    innerDiv.id = divId;
                    stepBox.appendChild(innerDiv);
                    container.appendChild(stepBox);

                    // åˆå§‹åŒ–å¾®å‹ Writerï¼Œåªé¡¯ç¤ºå‰ i ç•«ï¼Œä¸”ç¬¬ i ç•«è®Šç´…
                    HanziWriter.create(divId, char, {
                        width: 50, height: 50, padding: 2,
                        showCharacter: false,
                        showOutline: true,
                        showHintAfterMisses: 0,
                        strokeColor: (strokeData) => {
                            // å¦‚æœæ˜¯ç•¶å‰é€™ä¸€ç­†(ç¬¬ i ç­†ï¼Œç´¢å¼• i-1)ï¼Œé¡¯ç¤ºç´…è‰²ï¼Œå…¶ä»–çš„é¡¯ç¤ºé»‘è‰²
                            return strokeData.strokeNum === (i-1) ? '#e74c3c' : '#333';
                        }
                    });
                }
            }).catch(e => {
                container.innerHTML = "ç„¡æ³•è¼‰å…¥æ‹†è§£æ•¸æ“šï¼Œè«‹æª¢æŸ¥ç¶²è·¯ã€‚";
            });
        }

        // --- è¼”åŠ©åŠŸèƒ½ ---
        function animateWriter() { writerDemo.animateCharacter(); }
        function resetQuiz() { writerQuiz.quiz(); }
        
        function speakCurrentWord() {
            // ä½¿ç”¨ç€è¦½å™¨å…§å»ºèªéŸ³åˆæˆ
            const utterance = new SpeechSynthesisUtterance(currentWord);
            utterance.lang = 'zh-TW';
            utterance.rate = 0.8; // ç¨å¾®æ…¢ä¸€é»ï¼Œé©åˆæ•™å­¸
            window.speechSynthesis.speak(utterance);
        }
        
    </script>
</body>
</html>
